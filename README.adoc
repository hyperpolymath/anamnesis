= Anamnesis

image:https://img.shields.io/badge/License-MPL_2.0-blue.svg[MPL-2.0,link="https://opensource.org/licenses/MPL-2.0"]
image:https://img.shields.io/badge/Philosophy-Palimpsest-purple.svg[Palimpsest,link="https://github.com/hyperpolymath/palimpsest-licence"]


*A conversation knowledge extraction and reconciliation system for multi-LLM development workflows.*

== Problem

Modern AI-assisted development creates chaos:

- *Mixed-project conversations* - Multiple projects discussed in single threads
- *Dead-end tangents* - Valuable ideas lost in conversation noise
- *Lost context* - Decisions and rationale buried across chat histories
- *Artifact fragmentation* - Code/docs created, modified, abandoned across sessions
- *Multi-LLM mayhem* - Switching between Claude, ChatGPT, Mistral with no unified view

== Solution

Anamnesis parses tangled multi-LLM discussion threads, tracks artifact lifecycles (createdâ†’modifiedâ†’removedâ†’evaluated), cross-links related fragments across conversations, and generates clean summaries with content properly bucketed by project/topic.

== Architecture

Multi-language functional system leveraging each language's strengths:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Data Sources: Claude, ChatGPT, Mistral, Git, Browser History  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Parser (OCaml): Angstrom combinators, type-safe format parsingâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Orchestrator (Elixir): OTP supervision, port pools, HTTP API  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                         â”‚
            â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Reasoning (Î»Prolog)   â”‚  â”‚ Analytics (Julia)                    â”‚
â”‚ - Artifact lifecycle  â”‚  â”‚ - RDF generation (Serd.jl)          â”‚
â”‚ - Contamination       â”‚  â”‚ - SPARQL queries (HTTP.jl)          â”‚
â”‚ - Fuzzy categorizationâ”‚  â”‚ - Reservoir computing (ESN)         â”‚
â”‚ - Meta-reasoning      â”‚  â”‚ - KBANN (knowledge-augmented nets)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Storage (Virtuoso): RDF triplestore, SPARQL 1.1, named graphs â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Visualization (ReScript): Reagraph graphs, timeline charts,   â”‚
â”‚  fuzzy category viz, type-safe functional React components     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

== Technology Stack

| Layer | Technology | Why |
|-------|-----------|-----|
| *Parsing* | OCaml (Angstrom, Atdgen) | Type safety, parser combinators, ELPI integration |
| *Orchestration* | Elixir/OTP | Fault tolerance, concurrency, supervision trees |
| *Reasoning* | Î»Prolog (ELPI) | Higher-order abstract syntax, meta-reasoning |
| *Analytics* | Julia | Scientific computing without Python, RDF, reservoir computing |
| *Storage* | Virtuoso + SPARQL | RDF native, named graphs, inference |
| *Visualization* | ReScript + React | Type safety, functional paradigm, eventual JS replacement |

=== Critical Constraints

- âŒ *NO PYTHON* - Use Julia for all scientific computing
- âœ… *Type safety* throughout (OCaml, ReScript, Elixir typespecs)
- âœ… *Functional paradigm* - Immutability, pure functions, declarative
- âœ… *Multi-LLM* from start (stub complexity initially)
- âœ… *Academic rigor* - Research-grade documentation

== Project Structure

```
.
â”œâ”€â”€ CLAUDE.md                    # Claude Code guidance
â”œâ”€â”€ README.md                    # This file
â”œâ”€â”€ parser/                      # OCaml parsing components
â”‚   â”œâ”€â”€ lib/parsers/            # Format-specific parsers
â”‚   â”œâ”€â”€ bin/                    # Port executable
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ orchestrator/               # Elixir orchestration layer
â”‚   â”œâ”€â”€ lib/anamnesis/         # Core logic
â”‚   â”œâ”€â”€ lib/anamnesis_web/     # Phoenix HTTP API
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ reasoning/                  # Î»Prolog meta-reasoning
â”‚   â”œâ”€â”€ lifecycle/             # Artifact state machines
â”‚   â”œâ”€â”€ categorization/        # Fuzzy membership, contamination
â”‚   â”œâ”€â”€ linking/               # Cross-conversation references
â”‚   â”œâ”€â”€ episodic/              # Memory queries
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ learning/                   # Julia analytics
â”‚   â”œâ”€â”€ src/rdf/               # RDF manipulation
â”‚   â”œâ”€â”€ src/reservoir/         # Reservoir computing, KBANN
â”‚   â”œâ”€â”€ src/graphs/            # Graph processing
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ visualization/              # ReScript UI
â”‚   â”œâ”€â”€ src/components/        # React components
â”‚   â”œâ”€â”€ src/bindings/          # JS library bindings
â”‚   â”œâ”€â”€ src/types/             # Domain types
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ proving-ground/             # Test workspace
â”‚   â””â”€â”€ (zotero-voyant-export copy)
â””â”€â”€ docs/
    â”œâ”€â”€ architecture/          # System architecture
    â”œâ”€â”€ research/              # Tech stack research
    â”œâ”€â”€ guides/                # Integration guides
    â””â”€â”€ specifications/        # RDF schemas, protocols
```

== Getting Started

=== Prerequisites

- *OCaml* 5.0+ (via OPAM)
- *Elixir* 1.15+ (via asdf or package manager)
- *Julia* 1.10+ (via juliaup)
- *Node.js* 18+ (for ReScript)
- *Virtuoso* 7+ (via Docker or native)

=== Quick Start

```bash
= 1. Install language runtimes (see component READMEs)

= 2. Build parser (OCaml)

cd parser
opam install --deps-only .
dune build

= 3. Build orchestrator (Elixir)

cd ../orchestrator
mix deps.get
mix compile

= 4. Build reasoning (Î»Prolog via OCaml/ELPI)

cd ../reasoning
dune build

= 5. Setup analytics (Julia)

cd ../learning
julia --project=. -e 'using Pkg; Pkg.instantiate()'

= 6. Build visualization (ReScript)

cd ../visualization
npm install
npm run res:build

= 7. Start Virtuoso (Docker)

docker run -d -p 8890:8890 -p 1111:1111 \
  -e DBA_PASSWORD=anamnesis \
  --name virtuoso \
  openlink/virtuoso-opensource-7

= 8. Run Anamnesis

cd ../orchestrator
mix phx.server
= Visit http://localhost:4000

```

== Current Status

*Phase: Initial Implementation*

=== Completed âœ…

- [x] Project architecture designed
- [x] Comprehensive tech stack research (6 detailed reports)
- [x] Directory structure created
- [x] Component READMEs written
- [x] CLAUDE.md guidance created
- [x] OCaml Claude parser implemented
- [x] Elixir port infrastructure
- [x] Julia RDF modules (schema, serialization, SPARQL, Virtuoso)
- [x] Julia reservoir computing modules (ESN, embeddings)
- [x] Julia graph analysis modules
- [x] ReScript domain types and color mixing

=== In Progress ğŸš§

- [ ] End-to-end integration testing
- [ ] Î»Prolog reasoning module implementation
- [ ] Virtuoso storage integration
- [ ] Additional LLM format parsers (ChatGPT, Mistral)

=== Phase 1 Roadmap ğŸ“‹

1. âœ… Create Anamnesis repository
2. âœ… Research tech options (Julia RDF, reservoir computing, ReScript viz, OCaml parsers, Î»Prolog)
3. â¬œ Copy proving ground (zotero-voyant-export)
4. âœ… Setup basic infrastructure (build systems, test frameworks)
5. ğŸš§ *Milestone 1*: Parse single Claude conversation JSON â†’ Virtuoso RDF triples

=== Phase 2: Milestone 1 ğŸ¯

*Goal*: End-to-end pipeline for one conversation format

- [x] Claude JSON format parser (OCaml)
- [x] Port communication (OCaml â†” Elixir)
- [x] Basic RDF generation (Julia)
- [ ] Virtuoso storage integration
- [ ] Simple graph visualization (ReScript)

== Key Design Concepts

=== Multi-Category Membership

Conversations don't belong to just one project. Anamnesis supports fuzzy boundaries:

```turtle
anamnesis:conv:123 anamnesis:belongsTo anamnesis:proj:anamnesis ;
                   anamnesis:membershipStrength 0.8 .

anamnesis:conv:123 anamnesis:belongsTo anamnesis:proj:rescript-evangeliser ;
                   anamnesis:membershipStrength 0.3 .
```

Visualized via color mixing: 80% green (Anamnesis) + 30% orange (ReScript) = blended color.

=== Artifact Lifecycle Tracking

Track state transitions over time:

```prolog
% Î»Prolog rules
valid_transition created modified.
valid_transition modified evaluated.
valid_transition modified removed.

current_state artifact_123 timestamp_456 State.
% State = modified
```

=== Cross-Conversation Linking

Fragment references span conversations:

```sparql
= SPARQL query

SELECT ?conv1 ?conv2 ?artifact
WHERE {
  GRAPH ?g1 { ?conv1 anamnesis:discusses ?artifact . }
  GRAPH ?g2 { ?conv2 anamnesis:discusses ?artifact . }
  FILTER(?conv1 != ?conv2)
}
```

=== Episodic Memory

Named graphs partition conversations by episode:

```
graph:conversation:uuid-1  # Conversation metadata
graph:artifacts:uuid-1     # Artifact lifecycles
graph:links:uuid-1         # Cross-references
graph:categories:uuid-1    # Project membership
```

== Documentation

- *Architecture*: `/docs/architecture/system-architecture.adoc` - Complete system design
- *Research*: `/docs/research/` - Tech stack evaluations:
  - `julia-rdf-ecosystem.adoc` - RDF libraries (Serd.jl recommended)
  - `julia-reservoir-computing.adoc` - ESN, KBANN (ReservoirComputing.jl)
  - `puppygraph-evaluation.adoc` - Property graphs vs RDF (stick with Virtuoso)
  - `rescript-visualization.adoc` - Reagraph, rescript-recharts
  - `ocaml-parsing-elixir-bridge.adoc` - Angstrom, ports vs NIFs
  - `lambda-prolog-meta-reasoning.adoc` - ELPI, HOAS, integration
- *Component READMEs*: Each directory has detailed setup/usage docs
- *CLAUDE.md*: Guidance for Claude Code when working on this project

== Testing

=== Proving Ground

The `zotero-voyant-export` repository is our test case - it's contaminated with Anamnesis planning discussions mixed into Zotero export tool development. This IS the problem we're solving.

*Strategy*:
1. Copy entire repo to `proving-ground/`
2. Preserve original
3. Run Anamnesis pipeline
4. Verify correct untangling
5. Store iterations for comparison

=== Test Coverage Targets

- Parser: 90%+ (property-based testing with qcheck)
- Orchestrator: 85%+ (ExUnit + StreamData)
- Analytics: 80%+ (Test.jl)
- Visualization: 75%+ (Jest + React Testing Library)
- Reasoning: Example-driven (Î»Prolog test harness)

== Performance Targets

| Component | Target | Strategy |
|-----------|--------|----------|
| Parser throughput | 100 conversations/sec | Parallel ports, incremental parsing |
| Î»Prolog queries | <100ms | ETS caching, tabled predicates |
| SPARQL queries | <50ms simple, <500ms complex | Virtuoso indexing |
| Graph viz | 1000-5000 nodes interactive | WebGL (Reagraph), LOD |
| RDF storage | 10M+ triples | Named graph partitioning |

== Related Projects

- *ReScript Evangeliser* - Learning curve synergies
- *Zotero:NSAI* - Neurosymbolic AI integration
- *Fogbinder* - Uncertainty-as-feature framework

== Contributing

This is a personal research project, but architecture decisions are documented for transparency. See component READMEs for development guidelines.

== Academic Context

Relevant to user's research/journalism work:

- *Agnotology* - Study of culturally-induced ignorance
- *Axiology* - Theory of value
- *Ethics* - Moral philosophy applications
- *Knowledge representation* - Formal semantics, RDF, logic programming

== License

To be determined.

== Resources

- Repository: https://github.com/Hyperpolymath/anamnesis
- Test Case: zotero-voyant-export (to be copied to proving-ground)
- Handover Docs: `zotero-voyant-export/docs/contamination-notice/`
  - ANAMNESIS_HANDOVER_MINIMAL.adoc
  - THREAD_CONTAMINATION_WARNING.adoc

---

*Status*: Initial implementation phase. Core infrastructure complete, working toward Milestone 1.

*Next Immediate Steps*: Complete end-to-end testing and Virtuoso integration.
